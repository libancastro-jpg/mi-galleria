{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  const BASE_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'https://aviary-dashboard.preview.emergentagent.com';\n\n  // Callback para manejar logout cuando hay error 401\n  let onUnauthorized = null;\n  class ApiService {\n    token = null;\n    setToken(token) {\n      this.token = token;\n    }\n    setOnUnauthorized(callback) {\n      onUnauthorized = callback;\n    }\n    async request(endpoint, options = {}) {\n      const url = `${BASE_URL}/api${endpoint}`;\n      const headers = Object.assign({\n        'Content-Type': 'application/json'\n      }, options.headers || {});\n      if (this.token) {\n        headers['Authorization'] = `Bearer ${this.token}`;\n      }\n      try {\n        const response = await fetch(url, Object.assign({}, options, {\n          headers\n        }));\n\n        // Si es 401 Unauthorized, forzar logout\n        if (response.status === 401) {\n          console.log('Token inválido, forzando logout...');\n          if (onUnauthorized) {\n            onUnauthorized();\n          }\n          throw new Error('Sesión expirada');\n        }\n        const data = await response.json();\n        if (!response.ok) {\n          throw new Error(data.detail || 'Error en la solicitud');\n        }\n        return data;\n      } catch (error) {\n        if (error.message === 'Network request failed') {\n          throw new Error('Sin conexión a internet');\n        }\n        throw error;\n      }\n    }\n    async get(endpoint, params) {\n      let url = endpoint;\n      if (params) {\n        const searchParams = new URLSearchParams(params);\n        url = `${endpoint}?${searchParams.toString()}`;\n      }\n      return this.request(url, {\n        method: 'GET'\n      });\n    }\n    async post(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'POST',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async put(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'PUT',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async delete(endpoint) {\n      return this.request(endpoint, {\n        method: 'DELETE'\n      });\n    }\n  }\n  const api = new ApiService();\n});","lineCount":88,"map":[[7,2,87,0,"Object"],[7,8,87,0],[7,9,87,0,"defineProperty"],[7,23,87,0],[7,24,87,0,"exports"],[7,31,87,0],[8,4,87,0,"enumerable"],[8,14,87,0],[9,4,87,0,"get"],[9,7,87,0],[9,18,87,0,"get"],[9,19,87,0],[10,6,87,0],[10,13,87,0,"api"],[10,16,87,0],[11,4,87,0],[12,2,87,0],[13,2,87,36],[13,6,87,36,"_expoVirtualEnv"],[13,21,87,36],[13,24,87,36,"require"],[13,31,87,36],[13,32,87,36,"_dependencyMap"],[13,46,87,36],[14,2,1,0],[14,8,1,6,"BASE_URL"],[14,16,1,14],[14,19,1,17,"_expoVirtualEnv"],[14,34,1,17],[14,35,1,17,"env"],[14,38,1,17],[14,39,1,17,"EXPO_PUBLIC_BACKEND_URL"],[14,62,1,17],[14,66,1,56],[14,118,1,108],[16,2,3,0],[17,2,4,0],[17,6,4,4,"onUnauthorized"],[17,20,4,39],[17,23,4,42],[17,27,4,46],[18,2,6,0],[18,8,6,6,"ApiService"],[18,18,6,16],[18,19,6,17],[19,4,7,10,"token"],[19,9,7,15],[19,12,7,33],[19,16,7,37],[20,4,9,2,"setToken"],[20,12,9,10,"setToken"],[20,13,9,11,"token"],[20,18,9,31],[20,20,9,33],[21,6,10,4],[21,10,10,8],[21,11,10,9,"token"],[21,16,10,14],[21,19,10,17,"token"],[21,24,10,22],[22,4,11,2],[23,4,13,2,"setOnUnauthorized"],[23,21,13,19,"setOnUnauthorized"],[23,22,13,20,"callback"],[23,30,13,40],[23,32,13,42],[24,6,14,4,"onUnauthorized"],[24,20,14,18],[24,23,14,21,"callback"],[24,31,14,29],[25,4,15,2],[26,4,17,2],[26,10,17,16,"request"],[26,17,17,23,"request"],[26,18,17,24,"endpoint"],[26,26,17,40],[26,28,17,42,"options"],[26,35,17,62],[26,38,17,65],[26,39,17,66],[26,40,17,67],[26,42,17,69],[27,6,18,4],[27,12,18,10,"url"],[27,15,18,13],[27,18,18,16],[27,21,18,19,"BASE_URL"],[27,29,18,27],[27,36,18,34,"endpoint"],[27,44,18,42],[27,46,18,44],[28,6,20,4],[28,12,20,10,"headers"],[28,19,20,30],[28,22,20,30,"Object"],[28,28,20,30],[28,29,20,30,"assign"],[28,35,20,30],[29,8,21,6],[29,22,21,20],[29,24,21,22],[30,6,21,40],[30,9,22,10,"options"],[30,16,22,17],[30,17,22,18,"headers"],[30,24,22,25],[30,28,22,29],[30,29,22,30],[30,30,22,31],[30,31,23,5],[31,6,25,4],[31,10,25,8],[31,14,25,12],[31,15,25,13,"token"],[31,20,25,18],[31,22,25,20],[32,8,26,7,"headers"],[32,15,26,14],[32,16,26,42],[32,31,26,57],[32,32,26,58],[32,35,26,61],[32,45,26,71],[32,49,26,75],[32,50,26,76,"token"],[32,55,26,81],[32,57,26,83],[33,6,27,4],[34,6,29,4],[34,10,29,8],[35,8,30,6],[35,14,30,12,"response"],[35,22,30,20],[35,25,30,23],[35,31,30,29,"fetch"],[35,36,30,34],[35,37,30,35,"url"],[35,40,30,38],[35,42,30,38,"Object"],[35,48,30,38],[35,49,30,38,"assign"],[35,55,30,38],[35,60,31,11,"options"],[35,67,31,18],[36,10,32,8,"headers"],[37,8,32,15],[37,10,33,7],[37,11,33,8],[39,8,35,6],[40,8,36,6],[40,12,36,10,"response"],[40,20,36,18],[40,21,36,19,"status"],[40,27,36,25],[40,32,36,30],[40,35,36,33],[40,37,36,35],[41,10,37,8,"console"],[41,17,37,15],[41,18,37,16,"log"],[41,21,37,19],[41,22,37,20],[41,58,37,56],[41,59,37,57],[42,10,38,8],[42,14,38,12,"onUnauthorized"],[42,28,38,26],[42,30,38,28],[43,12,39,10,"onUnauthorized"],[43,26,39,24],[43,27,39,25],[43,28,39,26],[44,10,40,8],[45,10,41,8],[45,16,41,14],[45,20,41,18,"Error"],[45,25,41,23],[45,26,41,24],[45,43,41,41],[45,44,41,42],[46,8,42,6],[47,8,44,6],[47,14,44,12,"data"],[47,18,44,16],[47,21,44,19],[47,27,44,25,"response"],[47,35,44,33],[47,36,44,34,"json"],[47,40,44,38],[47,41,44,39],[47,42,44,40],[48,8,46,6],[48,12,46,10],[48,13,46,11,"response"],[48,21,46,19],[48,22,46,20,"ok"],[48,24,46,22],[48,26,46,24],[49,10,47,8],[49,16,47,14],[49,20,47,18,"Error"],[49,25,47,23],[49,26,47,24,"data"],[49,30,47,28],[49,31,47,29,"detail"],[49,37,47,35],[49,41,47,39],[49,64,47,62],[49,65,47,63],[50,8,48,6],[51,8,50,6],[51,15,50,13,"data"],[51,19,50,17],[52,6,51,4],[52,7,51,5],[52,8,51,6],[52,15,51,13,"error"],[52,20,51,23],[52,22,51,25],[53,8,52,6],[53,12,52,10,"error"],[53,17,52,15],[53,18,52,16,"message"],[53,25,52,23],[53,30,52,28],[53,54,52,52],[53,56,52,54],[54,10,53,8],[54,16,53,14],[54,20,53,18,"Error"],[54,25,53,23],[54,26,53,24],[54,51,53,49],[54,52,53,50],[55,8,54,6],[56,8,55,6],[56,14,55,12,"error"],[56,19,55,17],[57,6,56,4],[58,4,57,2],[59,4,59,2],[59,10,59,8,"get"],[59,13,59,11,"get"],[59,14,59,12,"endpoint"],[59,22,59,28],[59,24,59,30,"params"],[59,30,59,61],[59,32,59,63],[60,6,60,4],[60,10,60,8,"url"],[60,13,60,11],[60,16,60,14,"endpoint"],[60,24,60,22],[61,6,61,4],[61,10,61,8,"params"],[61,16,61,14],[61,18,61,16],[62,8,62,6],[62,14,62,12,"searchParams"],[62,26,62,24],[62,29,62,27],[62,33,62,31,"URLSearchParams"],[62,48,62,46],[62,49,62,47,"params"],[62,55,62,53],[62,56,62,54],[63,8,63,6,"url"],[63,11,63,9],[63,14,63,12],[63,17,63,15,"endpoint"],[63,25,63,23],[63,29,63,27,"searchParams"],[63,41,63,39],[63,42,63,40,"toString"],[63,50,63,48],[63,51,63,49],[63,52,63,50],[63,54,63,52],[64,6,64,4],[65,6,65,4],[65,13,65,11],[65,17,65,15],[65,18,65,16,"request"],[65,25,65,23],[65,26,65,24,"url"],[65,29,65,27],[65,31,65,29],[66,8,65,31,"method"],[66,14,65,37],[66,16,65,39],[67,6,65,45],[67,7,65,46],[67,8,65,47],[68,4,66,2],[69,4,68,2],[69,10,68,8,"post"],[69,14,68,12,"post"],[69,15,68,13,"endpoint"],[69,23,68,29],[69,25,68,31,"data"],[69,29,68,41],[69,31,68,43],[70,6,69,4],[70,13,69,11],[70,17,69,15],[70,18,69,16,"request"],[70,25,69,23],[70,26,69,24,"endpoint"],[70,34,69,32],[70,36,69,34],[71,8,70,6,"method"],[71,14,70,12],[71,16,70,14],[71,22,70,20],[72,8,71,6,"body"],[72,12,71,10],[72,14,71,12,"data"],[72,18,71,16],[72,21,71,19,"JSON"],[72,25,71,23],[72,26,71,24,"stringify"],[72,35,71,33],[72,36,71,34,"data"],[72,40,71,38],[72,41,71,39],[72,44,71,42,"undefined"],[73,6,72,4],[73,7,72,5],[73,8,72,6],[74,4,73,2],[75,4,75,2],[75,10,75,8,"put"],[75,13,75,11,"put"],[75,14,75,12,"endpoint"],[75,22,75,28],[75,24,75,30,"data"],[75,28,75,40],[75,30,75,42],[76,6,76,4],[76,13,76,11],[76,17,76,15],[76,18,76,16,"request"],[76,25,76,23],[76,26,76,24,"endpoint"],[76,34,76,32],[76,36,76,34],[77,8,77,6,"method"],[77,14,77,12],[77,16,77,14],[77,21,77,19],[78,8,78,6,"body"],[78,12,78,10],[78,14,78,12,"data"],[78,18,78,16],[78,21,78,19,"JSON"],[78,25,78,23],[78,26,78,24,"stringify"],[78,35,78,33],[78,36,78,34,"data"],[78,40,78,38],[78,41,78,39],[78,44,78,42,"undefined"],[79,6,79,4],[79,7,79,5],[79,8,79,6],[80,4,80,2],[81,4,82,2],[81,10,82,8,"delete"],[81,16,82,14,"delete"],[81,17,82,15,"endpoint"],[81,25,82,31],[81,27,82,33],[82,6,83,4],[82,13,83,11],[82,17,83,15],[82,18,83,16,"request"],[82,25,83,23],[82,26,83,24,"endpoint"],[82,34,83,32],[82,36,83,34],[83,8,83,36,"method"],[83,14,83,42],[83,16,83,44],[84,6,83,53],[84,7,83,54],[84,8,83,55],[85,4,84,2],[86,2,85,0],[87,2,87,7],[87,8,87,13,"api"],[87,11,87,16],[87,14,87,19],[87,18,87,23,"ApiService"],[87,28,87,33],[87,29,87,34],[87,30,87,35],[88,0,87,36],[88,3]],"functionMap":{"names":["<global>","ApiService","ApiService#setToken","ApiService#setOnUnauthorized","ApiService#request","ApiService#get","ApiService#post","ApiService#put","ApiService#_delete"],"mappings":"AAA;ACK;ECG;GDE;EEE;GFE;EGE;GHwC;EIE;GJO;EKE;GLK;EME;GNK;EOE;GPE;CDC"},"hasCjsExports":false},"type":"js/module"}]}