{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  const BASE_URL = process.env.EXPO_PUBLIC_BACKEND_URL || 'https://gallera-manager.preview.emergentagent.com';\n\n  // Callback para manejar logout cuando hay error 401\n  let onUnauthorized = null;\n  class ApiService {\n    token = null;\n    setToken(token) {\n      this.token = token;\n    }\n    setOnUnauthorized(callback) {\n      onUnauthorized = callback;\n    }\n    async request(endpoint, options = {}) {\n      const url = `${BASE_URL}/api${endpoint}`;\n      const headers = {\n        'Content-Type': 'application/json',\n        ...(options.headers || {})\n      };\n      if (this.token) {\n        headers['Authorization'] = `Bearer ${this.token}`;\n      }\n      try {\n        const response = await fetch(url, {\n          ...options,\n          headers\n        });\n\n        // Si es 401 Unauthorized, forzar logout\n        if (response.status === 401) {\n          console.log('Token inválido, forzando logout...');\n          if (onUnauthorized) {\n            onUnauthorized();\n          }\n          throw new Error('Sesión expirada');\n        }\n        const data = await response.json();\n        if (!response.ok) {\n          throw new Error(data.detail || 'Error en la solicitud');\n        }\n        return data;\n      } catch (error) {\n        if (error.message === 'Network request failed') {\n          throw new Error('Sin conexión a internet');\n        }\n        throw error;\n      }\n    }\n    async get(endpoint, params) {\n      let url = endpoint;\n      if (params) {\n        const searchParams = new URLSearchParams(params);\n        url = `${endpoint}?${searchParams.toString()}`;\n      }\n      return this.request(url, {\n        method: 'GET'\n      });\n    }\n    async post(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'POST',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async put(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'PUT',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async delete(endpoint) {\n      return this.request(endpoint, {\n        method: 'DELETE'\n      });\n    }\n  }\n  const api = new ApiService();\n});","lineCount":89,"map":[[7,2,87,0,"Object"],[7,8,87,0],[7,9,87,0,"defineProperty"],[7,23,87,0],[7,24,87,0,"exports"],[7,31,87,0],[8,4,87,0,"enumerable"],[8,14,87,0],[9,4,87,0,"get"],[9,7,87,0],[9,18,87,0,"get"],[9,19,87,0],[10,6,87,0],[10,13,87,0,"api"],[10,16,87,0],[11,4,87,0],[12,2,87,0],[13,2,1,0],[13,8,1,6,"BASE_URL"],[13,16,1,14],[13,19,1,17,"process"],[13,26,1,24],[13,27,1,25,"env"],[13,30,1,28],[13,31,1,29,"EXPO_PUBLIC_BACKEND_URL"],[13,54,1,52],[13,58,1,56],[13,109,1,107],[15,2,3,0],[16,2,4,0],[16,6,4,4,"onUnauthorized"],[16,20,4,39],[16,23,4,42],[16,27,4,46],[17,2,6,0],[17,8,6,6,"ApiService"],[17,18,6,16],[17,19,6,17],[18,4,7,10,"token"],[18,9,7,15],[18,12,7,33],[18,16,7,37],[19,4,9,2,"setToken"],[19,12,9,10,"setToken"],[19,13,9,11,"token"],[19,18,9,31],[19,20,9,33],[20,6,10,4],[20,10,10,8],[20,11,10,9,"token"],[20,16,10,14],[20,19,10,17,"token"],[20,24,10,22],[21,4,11,2],[22,4,13,2,"setOnUnauthorized"],[22,21,13,19,"setOnUnauthorized"],[22,22,13,20,"callback"],[22,30,13,40],[22,32,13,42],[23,6,14,4,"onUnauthorized"],[23,20,14,18],[23,23,14,21,"callback"],[23,31,14,29],[24,4,15,2],[25,4,17,2],[25,10,17,16,"request"],[25,17,17,23,"request"],[25,18,17,24,"endpoint"],[25,26,17,40],[25,28,17,42,"options"],[25,35,17,62],[25,38,17,65],[25,39,17,66],[25,40,17,67],[25,42,17,69],[26,6,18,4],[26,12,18,10,"url"],[26,15,18,13],[26,18,18,16],[26,21,18,19,"BASE_URL"],[26,29,18,27],[26,36,18,34,"endpoint"],[26,44,18,42],[26,46,18,44],[27,6,20,4],[27,12,20,10,"headers"],[27,19,20,30],[27,22,20,33],[28,8,21,6],[28,22,21,20],[28,24,21,22],[28,42,21,40],[29,8,22,6],[29,12,22,10,"options"],[29,19,22,17],[29,20,22,18,"headers"],[29,27,22,25],[29,31,22,29],[29,32,22,30],[29,33,22,31],[30,6,23,4],[30,7,23,5],[31,6,25,4],[31,10,25,8],[31,14,25,12],[31,15,25,13,"token"],[31,20,25,18],[31,22,25,20],[32,8,26,7,"headers"],[32,15,26,14],[32,16,26,42],[32,31,26,57],[32,32,26,58],[32,35,26,61],[32,45,26,71],[32,49,26,75],[32,50,26,76,"token"],[32,55,26,81],[32,57,26,83],[33,6,27,4],[34,6,29,4],[34,10,29,8],[35,8,30,6],[35,14,30,12,"response"],[35,22,30,20],[35,25,30,23],[35,31,30,29,"fetch"],[35,36,30,34],[35,37,30,35,"url"],[35,40,30,38],[35,42,30,40],[36,10,31,8],[36,13,31,11,"options"],[36,20,31,18],[37,10,32,8,"headers"],[38,8,33,6],[38,9,33,7],[38,10,33,8],[40,8,35,6],[41,8,36,6],[41,12,36,10,"response"],[41,20,36,18],[41,21,36,19,"status"],[41,27,36,25],[41,32,36,30],[41,35,36,33],[41,37,36,35],[42,10,37,8,"console"],[42,17,37,15],[42,18,37,16,"log"],[42,21,37,19],[42,22,37,20],[42,58,37,56],[42,59,37,57],[43,10,38,8],[43,14,38,12,"onUnauthorized"],[43,28,38,26],[43,30,38,28],[44,12,39,10,"onUnauthorized"],[44,26,39,24],[44,27,39,25],[44,28,39,26],[45,10,40,8],[46,10,41,8],[46,16,41,14],[46,20,41,18,"Error"],[46,25,41,23],[46,26,41,24],[46,43,41,41],[46,44,41,42],[47,8,42,6],[48,8,44,6],[48,14,44,12,"data"],[48,18,44,16],[48,21,44,19],[48,27,44,25,"response"],[48,35,44,33],[48,36,44,34,"json"],[48,40,44,38],[48,41,44,39],[48,42,44,40],[49,8,46,6],[49,12,46,10],[49,13,46,11,"response"],[49,21,46,19],[49,22,46,20,"ok"],[49,24,46,22],[49,26,46,24],[50,10,47,8],[50,16,47,14],[50,20,47,18,"Error"],[50,25,47,23],[50,26,47,24,"data"],[50,30,47,28],[50,31,47,29,"detail"],[50,37,47,35],[50,41,47,39],[50,64,47,62],[50,65,47,63],[51,8,48,6],[52,8,50,6],[52,15,50,13,"data"],[52,19,50,17],[53,6,51,4],[53,7,51,5],[53,8,51,6],[53,15,51,13,"error"],[53,20,51,23],[53,22,51,25],[54,8,52,6],[54,12,52,10,"error"],[54,17,52,15],[54,18,52,16,"message"],[54,25,52,23],[54,30,52,28],[54,54,52,52],[54,56,52,54],[55,10,53,8],[55,16,53,14],[55,20,53,18,"Error"],[55,25,53,23],[55,26,53,24],[55,51,53,49],[55,52,53,50],[56,8,54,6],[57,8,55,6],[57,14,55,12,"error"],[57,19,55,17],[58,6,56,4],[59,4,57,2],[60,4,59,2],[60,10,59,8,"get"],[60,13,59,11,"get"],[60,14,59,12,"endpoint"],[60,22,59,28],[60,24,59,30,"params"],[60,30,59,61],[60,32,59,63],[61,6,60,4],[61,10,60,8,"url"],[61,13,60,11],[61,16,60,14,"endpoint"],[61,24,60,22],[62,6,61,4],[62,10,61,8,"params"],[62,16,61,14],[62,18,61,16],[63,8,62,6],[63,14,62,12,"searchParams"],[63,26,62,24],[63,29,62,27],[63,33,62,31,"URLSearchParams"],[63,48,62,46],[63,49,62,47,"params"],[63,55,62,53],[63,56,62,54],[64,8,63,6,"url"],[64,11,63,9],[64,14,63,12],[64,17,63,15,"endpoint"],[64,25,63,23],[64,29,63,27,"searchParams"],[64,41,63,39],[64,42,63,40,"toString"],[64,50,63,48],[64,51,63,49],[64,52,63,50],[64,54,63,52],[65,6,64,4],[66,6,65,4],[66,13,65,11],[66,17,65,15],[66,18,65,16,"request"],[66,25,65,23],[66,26,65,24,"url"],[66,29,65,27],[66,31,65,29],[67,8,65,31,"method"],[67,14,65,37],[67,16,65,39],[68,6,65,45],[68,7,65,46],[68,8,65,47],[69,4,66,2],[70,4,68,2],[70,10,68,8,"post"],[70,14,68,12,"post"],[70,15,68,13,"endpoint"],[70,23,68,29],[70,25,68,31,"data"],[70,29,68,41],[70,31,68,43],[71,6,69,4],[71,13,69,11],[71,17,69,15],[71,18,69,16,"request"],[71,25,69,23],[71,26,69,24,"endpoint"],[71,34,69,32],[71,36,69,34],[72,8,70,6,"method"],[72,14,70,12],[72,16,70,14],[72,22,70,20],[73,8,71,6,"body"],[73,12,71,10],[73,14,71,12,"data"],[73,18,71,16],[73,21,71,19,"JSON"],[73,25,71,23],[73,26,71,24,"stringify"],[73,35,71,33],[73,36,71,34,"data"],[73,40,71,38],[73,41,71,39],[73,44,71,42,"undefined"],[74,6,72,4],[74,7,72,5],[74,8,72,6],[75,4,73,2],[76,4,75,2],[76,10,75,8,"put"],[76,13,75,11,"put"],[76,14,75,12,"endpoint"],[76,22,75,28],[76,24,75,30,"data"],[76,28,75,40],[76,30,75,42],[77,6,76,4],[77,13,76,11],[77,17,76,15],[77,18,76,16,"request"],[77,25,76,23],[77,26,76,24,"endpoint"],[77,34,76,32],[77,36,76,34],[78,8,77,6,"method"],[78,14,77,12],[78,16,77,14],[78,21,77,19],[79,8,78,6,"body"],[79,12,78,10],[79,14,78,12,"data"],[79,18,78,16],[79,21,78,19,"JSON"],[79,25,78,23],[79,26,78,24,"stringify"],[79,35,78,33],[79,36,78,34,"data"],[79,40,78,38],[79,41,78,39],[79,44,78,42,"undefined"],[80,6,79,4],[80,7,79,5],[80,8,79,6],[81,4,80,2],[82,4,82,2],[82,10,82,8,"delete"],[82,16,82,14,"delete"],[82,17,82,15,"endpoint"],[82,25,82,31],[82,27,82,33],[83,6,83,4],[83,13,83,11],[83,17,83,15],[83,18,83,16,"request"],[83,25,83,23],[83,26,83,24,"endpoint"],[83,34,83,32],[83,36,83,34],[84,8,83,36,"method"],[84,14,83,42],[84,16,83,44],[85,6,83,53],[85,7,83,54],[85,8,83,55],[86,4,84,2],[87,2,85,0],[88,2,87,7],[88,8,87,13,"api"],[88,11,87,16],[88,14,87,19],[88,18,87,23,"ApiService"],[88,28,87,33],[88,29,87,34],[88,30,87,35],[89,0,87,36],[89,3]],"functionMap":{"names":["<global>","ApiService","ApiService#setToken","ApiService#setOnUnauthorized","ApiService#request","ApiService#get","ApiService#post","ApiService#put","ApiService#_delete"],"mappings":"AAA;ACK;ECG;GDE;EEE;GFE;EGE;GHwC;EIE;GJO;EKE;GLK;EME;GNK;EOE;GPE;CDC"},"hasCjsExports":false},"type":"js/module"}]}