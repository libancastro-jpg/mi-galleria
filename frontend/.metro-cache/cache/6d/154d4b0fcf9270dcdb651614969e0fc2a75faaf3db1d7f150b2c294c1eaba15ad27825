{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  const BASE_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'https://gallero-app.preview.emergentagent.com';\n\n  // Callback para manejar logout cuando hay error 401\n  let onUnauthorized = null;\n  class ApiService {\n    token = null;\n    setToken(token) {\n      this.token = token;\n    }\n    setOnUnauthorized(callback) {\n      onUnauthorized = callback;\n    }\n    async request(endpoint, options = {}) {\n      const url = `${BASE_URL}/api${endpoint}`;\n      const headers = {\n        'Content-Type': 'application/json',\n        ...(options.headers || {})\n      };\n      if (this.token) {\n        headers['Authorization'] = `Bearer ${this.token}`;\n      }\n      try {\n        const response = await fetch(url, {\n          ...options,\n          headers\n        });\n\n        // Si es 401 Unauthorized, forzar logout\n        if (response.status === 401) {\n          console.log('Token inválido, forzando logout...');\n          if (onUnauthorized) {\n            onUnauthorized();\n          }\n          throw new Error('Sesión expirada');\n        }\n        const data = await response.json();\n        if (!response.ok) {\n          throw new Error(data.detail || 'Error en la solicitud');\n        }\n        return data;\n      } catch (error) {\n        if (error.message === 'Network request failed') {\n          throw new Error('Sin conexión a internet');\n        }\n        throw error;\n      }\n    }\n    async get(endpoint, params) {\n      let url = endpoint;\n      if (params) {\n        const searchParams = new URLSearchParams(params);\n        url = `${endpoint}?${searchParams.toString()}`;\n      }\n      return this.request(url, {\n        method: 'GET'\n      });\n    }\n    async post(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'POST',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async put(endpoint, data) {\n      return this.request(endpoint, {\n        method: 'PUT',\n        body: data ? JSON.stringify(data) : undefined\n      });\n    }\n    async delete(endpoint) {\n      return this.request(endpoint, {\n        method: 'DELETE'\n      });\n    }\n  }\n  const api = new ApiService();\n});","lineCount":90,"map":[[7,2,87,0,"Object"],[7,8,87,0],[7,9,87,0,"defineProperty"],[7,23,87,0],[7,24,87,0,"exports"],[7,31,87,0],[8,4,87,0,"enumerable"],[8,14,87,0],[9,4,87,0,"get"],[9,7,87,0],[9,18,87,0,"get"],[9,19,87,0],[10,6,87,0],[10,13,87,0,"api"],[10,16,87,0],[11,4,87,0],[12,2,87,0],[13,2,87,36],[13,6,87,36,"_expoVirtualEnv"],[13,21,87,36],[13,24,87,36,"require"],[13,31,87,36],[13,32,87,36,"_dependencyMap"],[13,46,87,36],[14,2,1,0],[14,8,1,6,"BASE_URL"],[14,16,1,14],[14,19,1,17,"_expoVirtualEnv"],[14,34,1,17],[14,35,1,17,"env"],[14,38,1,17],[14,39,1,17,"EXPO_PUBLIC_BACKEND_URL"],[14,62,1,17],[14,66,1,56],[14,113,1,103],[16,2,3,0],[17,2,4,0],[17,6,4,4,"onUnauthorized"],[17,20,4,39],[17,23,4,42],[17,27,4,46],[18,2,6,0],[18,8,6,6,"ApiService"],[18,18,6,16],[18,19,6,17],[19,4,7,10,"token"],[19,9,7,15],[19,12,7,33],[19,16,7,37],[20,4,9,2,"setToken"],[20,12,9,10,"setToken"],[20,13,9,11,"token"],[20,18,9,31],[20,20,9,33],[21,6,10,4],[21,10,10,8],[21,11,10,9,"token"],[21,16,10,14],[21,19,10,17,"token"],[21,24,10,22],[22,4,11,2],[23,4,13,2,"setOnUnauthorized"],[23,21,13,19,"setOnUnauthorized"],[23,22,13,20,"callback"],[23,30,13,40],[23,32,13,42],[24,6,14,4,"onUnauthorized"],[24,20,14,18],[24,23,14,21,"callback"],[24,31,14,29],[25,4,15,2],[26,4,17,2],[26,10,17,16,"request"],[26,17,17,23,"request"],[26,18,17,24,"endpoint"],[26,26,17,40],[26,28,17,42,"options"],[26,35,17,62],[26,38,17,65],[26,39,17,66],[26,40,17,67],[26,42,17,69],[27,6,18,4],[27,12,18,10,"url"],[27,15,18,13],[27,18,18,16],[27,21,18,19,"BASE_URL"],[27,29,18,27],[27,36,18,34,"endpoint"],[27,44,18,42],[27,46,18,44],[28,6,20,4],[28,12,20,10,"headers"],[28,19,20,30],[28,22,20,33],[29,8,21,6],[29,22,21,20],[29,24,21,22],[29,42,21,40],[30,8,22,6],[30,12,22,10,"options"],[30,19,22,17],[30,20,22,18,"headers"],[30,27,22,25],[30,31,22,29],[30,32,22,30],[30,33,22,31],[31,6,23,4],[31,7,23,5],[32,6,25,4],[32,10,25,8],[32,14,25,12],[32,15,25,13,"token"],[32,20,25,18],[32,22,25,20],[33,8,26,7,"headers"],[33,15,26,14],[33,16,26,42],[33,31,26,57],[33,32,26,58],[33,35,26,61],[33,45,26,71],[33,49,26,75],[33,50,26,76,"token"],[33,55,26,81],[33,57,26,83],[34,6,27,4],[35,6,29,4],[35,10,29,8],[36,8,30,6],[36,14,30,12,"response"],[36,22,30,20],[36,25,30,23],[36,31,30,29,"fetch"],[36,36,30,34],[36,37,30,35,"url"],[36,40,30,38],[36,42,30,40],[37,10,31,8],[37,13,31,11,"options"],[37,20,31,18],[38,10,32,8,"headers"],[39,8,33,6],[39,9,33,7],[39,10,33,8],[41,8,35,6],[42,8,36,6],[42,12,36,10,"response"],[42,20,36,18],[42,21,36,19,"status"],[42,27,36,25],[42,32,36,30],[42,35,36,33],[42,37,36,35],[43,10,37,8,"console"],[43,17,37,15],[43,18,37,16,"log"],[43,21,37,19],[43,22,37,20],[43,58,37,56],[43,59,37,57],[44,10,38,8],[44,14,38,12,"onUnauthorized"],[44,28,38,26],[44,30,38,28],[45,12,39,10,"onUnauthorized"],[45,26,39,24],[45,27,39,25],[45,28,39,26],[46,10,40,8],[47,10,41,8],[47,16,41,14],[47,20,41,18,"Error"],[47,25,41,23],[47,26,41,24],[47,43,41,41],[47,44,41,42],[48,8,42,6],[49,8,44,6],[49,14,44,12,"data"],[49,18,44,16],[49,21,44,19],[49,27,44,25,"response"],[49,35,44,33],[49,36,44,34,"json"],[49,40,44,38],[49,41,44,39],[49,42,44,40],[50,8,46,6],[50,12,46,10],[50,13,46,11,"response"],[50,21,46,19],[50,22,46,20,"ok"],[50,24,46,22],[50,26,46,24],[51,10,47,8],[51,16,47,14],[51,20,47,18,"Error"],[51,25,47,23],[51,26,47,24,"data"],[51,30,47,28],[51,31,47,29,"detail"],[51,37,47,35],[51,41,47,39],[51,64,47,62],[51,65,47,63],[52,8,48,6],[53,8,50,6],[53,15,50,13,"data"],[53,19,50,17],[54,6,51,4],[54,7,51,5],[54,8,51,6],[54,15,51,13,"error"],[54,20,51,23],[54,22,51,25],[55,8,52,6],[55,12,52,10,"error"],[55,17,52,15],[55,18,52,16,"message"],[55,25,52,23],[55,30,52,28],[55,54,52,52],[55,56,52,54],[56,10,53,8],[56,16,53,14],[56,20,53,18,"Error"],[56,25,53,23],[56,26,53,24],[56,51,53,49],[56,52,53,50],[57,8,54,6],[58,8,55,6],[58,14,55,12,"error"],[58,19,55,17],[59,6,56,4],[60,4,57,2],[61,4,59,2],[61,10,59,8,"get"],[61,13,59,11,"get"],[61,14,59,12,"endpoint"],[61,22,59,28],[61,24,59,30,"params"],[61,30,59,61],[61,32,59,63],[62,6,60,4],[62,10,60,8,"url"],[62,13,60,11],[62,16,60,14,"endpoint"],[62,24,60,22],[63,6,61,4],[63,10,61,8,"params"],[63,16,61,14],[63,18,61,16],[64,8,62,6],[64,14,62,12,"searchParams"],[64,26,62,24],[64,29,62,27],[64,33,62,31,"URLSearchParams"],[64,48,62,46],[64,49,62,47,"params"],[64,55,62,53],[64,56,62,54],[65,8,63,6,"url"],[65,11,63,9],[65,14,63,12],[65,17,63,15,"endpoint"],[65,25,63,23],[65,29,63,27,"searchParams"],[65,41,63,39],[65,42,63,40,"toString"],[65,50,63,48],[65,51,63,49],[65,52,63,50],[65,54,63,52],[66,6,64,4],[67,6,65,4],[67,13,65,11],[67,17,65,15],[67,18,65,16,"request"],[67,25,65,23],[67,26,65,24,"url"],[67,29,65,27],[67,31,65,29],[68,8,65,31,"method"],[68,14,65,37],[68,16,65,39],[69,6,65,45],[69,7,65,46],[69,8,65,47],[70,4,66,2],[71,4,68,2],[71,10,68,8,"post"],[71,14,68,12,"post"],[71,15,68,13,"endpoint"],[71,23,68,29],[71,25,68,31,"data"],[71,29,68,41],[71,31,68,43],[72,6,69,4],[72,13,69,11],[72,17,69,15],[72,18,69,16,"request"],[72,25,69,23],[72,26,69,24,"endpoint"],[72,34,69,32],[72,36,69,34],[73,8,70,6,"method"],[73,14,70,12],[73,16,70,14],[73,22,70,20],[74,8,71,6,"body"],[74,12,71,10],[74,14,71,12,"data"],[74,18,71,16],[74,21,71,19,"JSON"],[74,25,71,23],[74,26,71,24,"stringify"],[74,35,71,33],[74,36,71,34,"data"],[74,40,71,38],[74,41,71,39],[74,44,71,42,"undefined"],[75,6,72,4],[75,7,72,5],[75,8,72,6],[76,4,73,2],[77,4,75,2],[77,10,75,8,"put"],[77,13,75,11,"put"],[77,14,75,12,"endpoint"],[77,22,75,28],[77,24,75,30,"data"],[77,28,75,40],[77,30,75,42],[78,6,76,4],[78,13,76,11],[78,17,76,15],[78,18,76,16,"request"],[78,25,76,23],[78,26,76,24,"endpoint"],[78,34,76,32],[78,36,76,34],[79,8,77,6,"method"],[79,14,77,12],[79,16,77,14],[79,21,77,19],[80,8,78,6,"body"],[80,12,78,10],[80,14,78,12,"data"],[80,18,78,16],[80,21,78,19,"JSON"],[80,25,78,23],[80,26,78,24,"stringify"],[80,35,78,33],[80,36,78,34,"data"],[80,40,78,38],[80,41,78,39],[80,44,78,42,"undefined"],[81,6,79,4],[81,7,79,5],[81,8,79,6],[82,4,80,2],[83,4,82,2],[83,10,82,8,"delete"],[83,16,82,14,"delete"],[83,17,82,15,"endpoint"],[83,25,82,31],[83,27,82,33],[84,6,83,4],[84,13,83,11],[84,17,83,15],[84,18,83,16,"request"],[84,25,83,23],[84,26,83,24,"endpoint"],[84,34,83,32],[84,36,83,34],[85,8,83,36,"method"],[85,14,83,42],[85,16,83,44],[86,6,83,53],[86,7,83,54],[86,8,83,55],[87,4,84,2],[88,2,85,0],[89,2,87,7],[89,8,87,13,"api"],[89,11,87,16],[89,14,87,19],[89,18,87,23,"ApiService"],[89,28,87,33],[89,29,87,34],[89,30,87,35],[90,0,87,36],[90,3]],"functionMap":{"names":["<global>","ApiService","ApiService#setToken","ApiService#setOnUnauthorized","ApiService#request","ApiService#get","ApiService#post","ApiService#put","ApiService#_delete"],"mappings":"AAA;ACK;ECG;GDE;EEE;GFE;EGE;GHwC;EIE;GJO;EKE;GLK;EME;GNK;EOE;GPE;CDC"},"hasCjsExports":false},"type":"js/module"}]}